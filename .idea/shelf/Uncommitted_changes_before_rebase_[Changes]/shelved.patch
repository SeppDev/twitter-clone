Index: src/modules/database.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?php\r\n$host = \"localhost\";\r\n\r\n$username = \"root\";\r\n$password = \"\";\r\n\r\n$GLOBALS[\"database\"] = new mysqli($host, $username);\r\n$GLOBALS[\"database\"]->select_db(\"twitter_clone\");\r\n\r\nif ($GLOBALS[\"database\"]->connect_error) {\r\n    echo \"Failed to connect\";\r\n    exit();\r\n}\r\n\r\nfunction build_error(string $message) {\r\n    die(json_encode(array(\r\n        \"error\" => $message,\r\n    )));\r\n}\r\n\r\nfunction create_user(string $username, string $password)\r\n{\r\n    $password_hash = hash(\"sha256\", $password);\r\n    $connection = $GLOBALS[\"database\"];\r\n\r\n    $sql = sprintf(\"INSERT INTO `users`(`id`, `username`, `password`, `reg_date`, `profile_img`) VALUES (NULL, \\\"%s\\\", \\\"%s\\\", NULL, \\\"LINK\\\")\", $username, $password_hash);\r\n\r\n    try {\r\n        $result = $connection->query($sql);\r\n        die(\"TODO\");\r\n    } catch (mysqli_sql_exception $e) {\r\n        build_error($e->getMessage());\r\n    }\r\n}\r\n\r\nfunction login_user(string $username, string $password)\r\n{\r\n    $password_hash = hash(\"sha256\", $password);\r\n    $connection = $GLOBALS[\"database\"];\r\n\r\n    $sql = sprintf(\"SELECT `id`, `password` FROM `users` WHERE username LIKE \\\"%s\\\"\", $username);\r\n    $result = $connection->query($sql);\r\n\r\n    if ($result->num_rows == 0) {\r\n        build_error(\"Username not found\");\r\n    }\r\n\r\n    $user = $result->fetch_row();\r\n\r\n    $id = $user[0];\r\n    $password = $user[1];\r\n\r\n    if ($password != $password_hash) {\r\n        build_error(\"Wrong password\");\r\n    }\r\n\r\n\r\n    die(json_encode(array(\r\n        \"session-token\" => create_user_session($id)\r\n    )));\r\n}\r\n\r\nfunction create_user_session(int $userid): string {\r\n    $token = random_bytes(32);\r\n\r\n    return $token;\r\n}\r\n\r\nfunction get_user_session() {\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/modules/database.php b/src/modules/database.php
--- a/src/modules/database.php	(revision 5f63fea6781fa89bda31eeb71530d1db739fe400)
+++ b/src/modules/database.php	(date 1727947515891)
@@ -68,4 +68,34 @@
 
 function get_user_session() {
 
+}
+
+$db = new PDO('mysql:host=localhost;dbname=twitter_clone', 'root', '');
+function sql($expression)
+{
+    global $db;
+    $query = $db->query($expression);
+    return $query->fetchAll(PDO::FETCH_ASSOC);
+}
+function post()
+{
+    return sql("SELECT * FROM posts");
+}
+function author($result) {
+    return sql("SELECT * FROM users WHERE id LIKE " . $result['author']);
+}
+
+function loadPosts() {
+    $result = post();
+    foreach ($result as $post) {
+        $result1 = author($post);
+        echo "<div class=\"tweet\">
+    <div class=\"profile\">
+        <div class=\"pfp\"><img src=" . $result1[0]['profile_img'] . " width=\"60px\" height=\"60px\" alt=\"\"></div>
+        <div class=\"name\">" . $result1[0]['username'] . "</div>
+    </div>
+    <div class=\"\content\">" . $post['content'] . "
+    </div>
+    </div>";
+    }
 }
\ No newline at end of file
